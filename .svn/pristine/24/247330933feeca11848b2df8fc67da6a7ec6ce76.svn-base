@page "/user/profile/{id}"


@inject Microsoft.Extensions.Configuration.IConfiguration config;
@inject IAuthService AuthService;
@inject NavigationManager NavigationManager
@inject IToastService _toastSvc;
@attribute [Authorize]
<UserNav></UserNav>
<AuthorizeView>
    <Authorized>
        <section class="author-profile-area">

            <div class="container">
                <div class="row">
                    <div class="col-lg-4">
                        <aside class="sidebar sidebar_author">
                            <div class="author-card sidebar-card">
                                <div class="author-infos">
                                    <div class="author_avatar">
                                        @try
                                        {
                                            @if (user.AvatarPath != null || !string.IsNullOrEmpty(user.AvatarPath))
                                            {
                                                <img src="user.AvatarPath" alt="Ảnh đại diện" style="width:160px; height:160px">
                                            }
                                            else
                                            {
                                                <img src="/images/avatar.jpg" alt="Ảnh đại diện" style="width:160px; height:160px">
                                            }



                                        }
                                        catch { }

                                    </div>
                                    <div class="author">
                                        <h4>@KhachName</h4>
                                        <p>@*Tham gia: @NgayThamGia*@</p>
                                    </div>
                                </div>
                            </div>

                        </aside>
                    </div>
                    <div class="col-lg-8 col-md-12">
                        <div class="row">
                            <div class="col-md-12 col-sm-12">
                                <div class="author_module about_author">
                                    <h2>
                                        Thông tin tài khoản
                                        <span>@KhachName</span>
                                    </h2>
                                    <p><span class="indam">Họ tên:</span> @KhachName</p>
                                    <p><span class="indam">Tên đăng nhập:</span> @user.UserName</p>
                                    <p><span class="indam">Email:</span> @user.Email</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </section>
    </Authorized>
    <NotAuthorized>
        Something went wrong !
    </NotAuthorized>
</AuthorizeView>

@code {

    [CascadingParameter] protected Task<AuthenticationState> AuthStat { get; set; }
    public string KhachName;
    public string UserName;
    public string Email;
    //public string NgayThamGia;
    //protected void OnInitialized()
    [Parameter] public string id { get; set; }
    public User user = new User();
    protected override async Task OnInitializedAsync()
    {

        var _user = await AuthService.GetUserFromId(id);
        user.LastName = _user.Data.LastName;
        user.FirstName = _user.Data.FirstName;
        KhachName = _user.Data.LastName + " " + _user.Data.FirstName;
        user.UserName = _user.Data.UserName;
        user.Email = _user.Data.Email;
        user.AvatarPath = _user.Data.AvatarPath;
    }


}

