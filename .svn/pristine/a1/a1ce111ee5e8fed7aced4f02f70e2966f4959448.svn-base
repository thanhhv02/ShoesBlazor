@page "/"
@inject IJSRuntime JSRuntime
@using PoPoy.Client.Services.ProductService
@using PoPoy.Shared.Dto;
@inject IProductService _productSvc;
@using PoPoy.Shared.Paging
<PageInfos Title="Trang chủ"></PageInfos>
<!-- hero section -->
<div class="hero">
    <div class="slider">
        <div class="container">

            @if (ProductList.Count() == 0)
            {
                <LoadingScreen></LoadingScreen>
            }
            else
            {
                foreach (var item in ProductList)
                {
        <div class="slide">
            <div class="info">
                <div class="info-content">
                    <h3 class="top-down">
                        @item.Title
                    </h3>
                    <h2 class="top-down trans-delay-0-2">
                        @item.Title
                    </h2>
                    <p class="top-down trans-delay-0-4">
                        @item.Description
                    </p>
                    <div class="top-down trans-delay-0-6">
                        <a class="btn-flat btn-hover" href="/product-detail/@item.Id">
                            <span>shop now</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="img top-down">
                @*@if (item.ProductImages != null && item.ProductImages.Any())
                {
                    <img src="@item.ProductImages.FirstOrDefault().ImagePath" alt="">
                }*@
                <img src="./images/JBL-Endurance-Sprint_Alt_Red-1605x1605px.webp" alt="">
            </div>
            

        </div>
                }

            }

        </div>
        <!-- slider controller -->
        <button class="slide-controll slide-next" @onclick="NextSlide">
            <i class='bx bxs-chevron-right'></i>
        </button>
        <button class="slide-controll slide-prev" @onclick="PreviousSlide">
            <i class='bx bxs-chevron-left'></i>
        </button>
        <!-- end slider controller -->
    </div>
</div>
<!-- end hero section -->
<!-- promotion section -->
<div class="promotion">
    <div class="row">
        <div class="col-4 col-md-12 col-sm-12">
            <div class="promotion-box">
                <div class="text">
                    <h3>Headphone & Earbuds</h3>
                    <button class="btn-flat btn-hover"><span>shop collection</span></button>
                </div>
                <img src="./images/JBLHorizon_001_dvHAMaster.png" alt="">
            </div>
        </div>
        <div class="col-4 col-md-12 col-sm-12">
            <div class="promotion-box">
                <div class="text">
                    <h3>JBL Quantum Series</h3>
                    <button class="btn-flat btn-hover"><span>shop collection</span></button>
                </div>
                <img src="./images/kisspng-beats-electronics-headphones-apple-beats-studio-red-headphones.png" alt="">
            </div>
        </div>
        <div class="col-4 col-md-12 col-sm-12">
            <div class="promotion-box">
                <div class="text">
                    <h3>True Wireless Earbuds</h3>
                    <button class="btn-flat btn-hover"><span>shop collection</span></button>
                </div>
                <img src="./images/JBL_TUNE220TWS_ProductImage_Pink_ChargingCaseOpen.png" alt="">
            </div>
        </div>
    </div>
</div>
<!-- end promotion section -->
<!-- product list -->
<div class="section">
    <div class="container">
        <div class="section-header">
            <h2>Latest product</h2>
        </div>
        <div class="row" id="latest-products">
            <div class="col-3 col-md-6 col-sm-12">
                <div class="product-card">
                    <div class="product-card-img">
                        <img src="./images/JBL_Quantum_400_Product Image_Hero 02.png" alt="">
                        <img src="./images/JBL_Quantum_400_Product Image_Hero Mic Up.webp" alt="">
                    </div>
                    <div class="product-card-info">
                        <div class="product-btn">
                            <button class="btn-flat btn-hover btn-shop-now">shop now</button>
                            <button class="btn-flat btn-hover btn-cart-add">
                                <i class='bx bxs-cart-add'></i>
                            </button>
                            <button class="btn-flat btn-hover btn-cart-add">
                                <i class='bx bxs-heart'></i>
                            </button>
                        </div>
                        <div class="product-card-name">
                            JBL Quantum 400
                        </div>
                        <div class="product-card-price">
                            <span><del>$300</del></span>
                            <span class="curr-price">$200</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section-footer">
            <a href="./products.html" class="btn-flat btn-hover">view all</a>
        </div>
    </div>
</div>
<!-- end product list -->
<!-- special product -->
<div class="bg-second">
    <div class="section container">
        <div class="row">
            <div class="col-4 col-md-4">
                <div class="sp-item-img">
                    <img src="./images/kisspng-beats-electronics-headphones-apple-beats-studio-red-headphones.png" alt="">
                </div>
            </div>
            <div class="col-7 col-md-8">
                <div class="sp-item-info">
                    <div class="sp-item-name">JBL TUNE 750TNC</div>
                    <p class="sp-item-description">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Labore dignissimos itaque et eaque quod harum vero autem? Reprehenderit enim non voluptate! Qui provident modi est non eius ratione, debitis iure.
                    </p>
                    <button class="btn-flat btn-hover">shop now</button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end special product -->
<!-- product list -->
<div class="section">
    <div class="container">
        <div class="section-header">
            <h2>best selling</h2>
        </div>
        <div class="row" id="best-products">
            <div class="col-3 col-md-6 col-sm-12">
                <div class="product-card">
                    <div class="product-card-img">
                        <img src="./images/JBL_Quantum_400_Product Image_Hero 02.png" alt="">
                        <img src="./images/JBL_Quantum_400_Product Image_Hero Mic Up.webp" alt="">
                    </div>
                    <div class="product-card-info">
                        <div class="product-btn">
                            <button class="btn-flat btn-hover btn-shop-now">shop now</button>
                            <button class="btn-flat btn-hover btn-cart-add">
                                <i class='bx bxs-cart-add'></i>
                            </button>
                            <button class="btn-flat btn-hover btn-cart-add">
                                <i class='bx bxs-heart'></i>
                            </button>
                        </div>
                        <div class="product-card-name">
                            JBL Quantum 400
                        </div>
                        <div class="product-card-price">
                            <span><del>$300</del></span>
                            <span class="curr-price">$200</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section-footer">
            <a href="./products.html" class="btn-flat btn-hover">view all</a>
        </div>
    </div>
</div>
<!-- end product list -->
<!-- blogs -->
<div class="section">
    <div class="container">
        <div class="section-header">
            <h2>latest blog</h2>
        </div>
        <div class="blog">
            <div class="blog-img">
                <img src="./images/JBL_Quantum400_Lifestyle1.png" alt="">
            </div>
            <div class="blog-info">
                <div class="blog-title">
                    Lorem ipsum dolor sit amet
                </div>
                <div class="blog-preview">
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quasi, eligendi dolore. Sapiente omnis numquam mollitia asperiores animi, veritatis sint illo magnam, voluptatum labore, quam ducimus! Nisi doloremque praesentium laudantium repellat.
                </div>
                <button class="btn-flat btn-hover">read more</button>
            </div>
        </div>
        <div class="blog row-revere">
            <div class="blog-img">
                <img src="./images/JBL_TUNE220TWS_Lifestyle_black.png" alt="">
            </div>
            <div class="blog-info">
                <div class="blog-title">
                    Lorem ipsum dolor sit amet
                </div>
                <div class="blog-preview">
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quasi, eligendi dolore. Sapiente omnis numquam mollitia asperiores animi, veritatis sint illo magnam, voluptatum labore, quam ducimus! Nisi doloremque praesentium laudantium repellat.
                </div>
                <button class="btn-flat btn-hover">read more</button>
            </div>
        </div>
        <div class="section-footer">
            <a href="#" class="btn-flat btn-hover">view all</a>
        </div>
    </div>
</div>
<!-- end blogs -->

@code{
    public List<Product> ProductList { get; set; } = new List<Product>();
    public MetaData MetaData { get; set; } = new MetaData();
    private ProductParameters _productParameters = new ProductParameters();

    protected override async Task OnInitializedAsync()
    {
        await GetProducts();
    }
    private async Task SelectedPage(int page)
    {
        _productParameters.PageNumber = page;
        await GetProducts();
    }
    private async Task GetProducts()
    {
        var pagingResponse = await _productSvc.GetAll(_productParameters);
        ProductList = pagingResponse.Items;
        MetaData = pagingResponse.MetaData;
    }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {

        await JSRuntime.InvokeAsync<IJSObjectReference>("import", "./js/index.js");

    }

    async Task NextSlide()
    {
        await JSRuntime.InvokeVoidAsync("nextSlide", null);
    }
    async Task PreviousSlide()
    {
        await JSRuntime.InvokeVoidAsync("prevSlide", null);
    }
}