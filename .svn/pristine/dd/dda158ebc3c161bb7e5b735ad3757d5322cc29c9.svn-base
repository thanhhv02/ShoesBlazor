@page "/product-detail/{id:int}"
@using PoPoy.Shared.Dto
@inject IProductService _productSvc;
@inject IToastService _toastSvc;
@using PoPoy.Client.Services.ProductService
@using PoPoy.Client.Services.CartService;
@inject ICartService _cartSvc;
@using Microsoft.Extensions.Configuration;
@inject IConfiguration _config;
<div class="bg-main">
    <div class="container">
        <div class="box">
            <div class="breadcumb">
                <a href="./index.html">home</a>
                <span><i class="bx bxs-chevrons-right"></i></span>
                <a href="./products.html">all products</a>
                <span><i class="bx bxs-chevrons-right"></i></span>
                <a href="./product-detail.html">JBL Tune 750TNC</a>
            </div>
        </div>
        <div class="row product-row">
            <div class="col-5">
                @try
                {
                    @if (product.ProductImages.Any())
                    {
                        <div class="product-img" id="product-img">
                            <img src="@product.ProductImages.FirstOrDefault().ImagePath" alt="">
                        </div>
                        <div class="box">
                            <div class="product-img-list">
                                @foreach (var item in product.ProductImages)
                                {
                                    <div class="product-img-item">
                                        <img src="@item.ImagePath" alt="">
                                    </div>
                                }
                            </div>
                        </div>
                    }
                    else
                    {
                        <img src="@_config["BackendApiUrl"]/uploads/no-photo-available.png" alt="">
                    }



                }
                catch { }


            </div>
            <div class="col-7">
                <div class="product-info">
                    <h1>
                        @product.Title
                    </h1>
                    <div class="product-info-detail">
                        <span class="product-info-detail-title">Brand:</span>
                        <a href="#">JBL</a>
                    </div>
                    <div class="product-info-detail">
                        <span class="product-info-detail-title">Rated:</span>
                        <span class="rating">
                            <i class="bx bxs-star"></i>
                            <i class="bx bxs-star"></i>
                            <i class="bx bxs-star"></i>
                            <i class="bx bxs-star"></i>
                            <i class="bx bxs-star"></i>
                        </span>
                    </div>
                    <p class="product-description">
                        @product.Description
                    </p>
                    <div class="product-info-price">$2345</div>

                    <SelectQuantity Model="@cart" CartUpdateType="CartUpdateType.Add" />
                    <div>
                        <button class="btn-flat btn-hover" @onclick="AddToCart">add to cart</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="box">
            <div class="box-header">
                description
            </div>
            <div class="product-detail-description">
                <button class="btn-flat btn-hover btn-view-description" id="view-all-description">
                    view all
                </button>
                <div class="product-detail-description-content">
                    <p>
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Impedit laudantium obcaecati odit dolorem, doloremque accusamus esse neque ipsa dignissimos saepe quisquam tempore perferendis deserunt sapiente! Recusandae illum totam earum ratione.
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Aliquam incidunt maxime rerum reprehenderit voluptas asperiores ipsam quas consequuntur maiores, at odit obcaecati vero sunt! Reiciendis aperiam perferendis consequuntur odio quas. Lorem ipsum dolor sit amet consectetur adipisicing elit. Ut quaerat eum veniam doloremque nihil repudiandae odio ratione culpa libero tempora. Expedita, quo molestias. Minus illo quis dignissimos aliquid sapiente error!
                    </p>
                    <img src="./images/JBL_Quantum_400_Product Image_Hero 02.png" alt="">
                    <p>
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Nobis accusantium officia, quae fuga in exercitationem aliquam labore ex doloribus repellendus beatae facilis ipsam. Veritatis vero obcaecati iste atque aspernatur ducimus.
                        Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repellat quam praesentium id sit amet magnam ad, dolorum, cumque iste optio itaque expedita eius similique, ab adipisci dicta. Quod, quibusdam quas. Lorem ipsum dolor sit amet consectetur adipisicing elit. Odit, in corrupti ipsam sint error possimus commodi incidunt suscipit sit voluptatum quibusdam enim eligendi animi deserunt recusandae earum natus voluptas blanditiis?
                    </p>
                    <img src="./images/kisspng-beats-electronics-headphones-apple-beats-studio-red-headphones.png" alt="">
                    <p>
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Modi ullam quam fugit veniam ipsum recusandae incidunt, ex ratione, magnam labore ad tenetur officia! In, totam. Molestias sapiente deserunt animi porro?
                    </p>
                </div>
            </div>
        </div>
        <div class="box">
            <div class="box-header">
                review
            </div>
            <div>
                <div class="user-rate">
                    <div class="user-info">
                        <div class="user-avt">
                            <img src="./images/tuat.jpg" alt="">
                        </div>
                        <div class="user-name">
                            <span class="name">tuat tran anh</span>
                            <span class="rating">
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                            </span>
                        </div>
                    </div>
                    <div class="user-rate-content">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio ea iste, veritatis nobis amet illum, cum alias magni dolores odio, eius quo excepturi veniam ipsa voluptatibus natus voluptas vero? Aspernatur!
                    </div>
                </div>
                <div class="user-rate">
                    <div class="user-info">
                        <div class="user-avt">
                            <img src="./images/tuat.jpg" alt="">
                        </div>
                        <div class="user-name">
                            <span class="name">tuat tran anh</span>
                            <span class="rating">
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                            </span>
                        </div>
                    </div>
                    <div class="user-rate-content">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio ea iste, veritatis nobis amet illum, cum alias magni dolores odio, eius quo excepturi veniam ipsa voluptatibus natus voluptas vero? Aspernatur!
                    </div>
                </div>
                <div class="user-rate">
                    <div class="user-info">
                        <div class="user-avt">
                            <img src="./images/tuat.jpg" alt="">
                        </div>
                        <div class="user-name">
                            <span class="name">tuat tran anh</span>
                            <span class="rating">
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                            </span>
                        </div>
                    </div>
                    <div class="user-rate-content">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio ea iste, veritatis nobis amet illum, cum alias magni dolores odio, eius quo excepturi veniam ipsa voluptatibus natus voluptas vero? Aspernatur!
                    </div>
                </div>
                <div class="user-rate">
                    <div class="user-info">
                        <div class="user-avt">
                            <img src="./images/tuat.jpg" alt="">
                        </div>
                        <div class="user-name">
                            <span class="name">tuat tran anh</span>
                            <span class="rating">
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                            </span>
                        </div>
                    </div>
                    <div class="user-rate-content">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio ea iste, veritatis nobis amet illum, cum alias magni dolores odio, eius quo excepturi veniam ipsa voluptatibus natus voluptas vero? Aspernatur!
                    </div>
                </div>
                <div class="user-rate">
                    <div class="user-info">
                        <div class="user-avt">
                            <img src="./images/tuat.jpg" alt="">
                        </div>
                        <div class="user-name">
                            <span class="name">tuat tran anh</span>
                            <span class="rating">
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                                <i class="bx bxs-star"></i>
                            </span>
                        </div>
                    </div>
                    <div class="user-rate-content">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Distinctio ea iste, veritatis nobis amet illum, cum alias magni dolores odio, eius quo excepturi veniam ipsa voluptatibus natus voluptas vero? Aspernatur!
                    </div>
                </div>
                <div class="box">
                    <ul class="pagination">
                        <li><a href="#"><i class="bx bxs-chevron-left"></i></a></li>
                        <li><a href="#" class="active">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                        <li><a href="#"><i class="bx bxs-chevron-right"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="box">
            <div class="box-header">
                related products
            </div>
            <div class="row" id="related-products">
                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/JBL_E55BT_KEY_BLACK_6175_FS_x1-1605x1605px.png" alt="">
                            <img src="./images/JBL_LIVE650BTNC_Product Image_Folded_Black.webp" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                JBL E55BT KEY BLACK
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/JBL_JR 310BT_Product Image_Hero_Skyblue.png" alt="">
                            <img src="./images/JBL_JR 310BT_Product Image_Detail_Skyblue.png" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                JBL JR 310BT
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/kisspng-beats-electronics-headphones-apple-beats-studio-red-headphones.png" alt="">
                            <img src="./images/JBL_E55BT_KEY_RED_6063_FS_x1-1605x1605px.webp" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                @product.Title
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/JBLHorizon_001_dvHAMaster.png" alt="">
                            <img src="./images/JBLHorizon_BLK_002_dvHAMaster.webp" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                JBL Horizon
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/JBL_TUNE220TWS_ProductImage_Pink_ChargingCaseOpen.png" alt="">
                            <img src="./images/JBL_TUNE220TWS_ProductImage_Pink_Back.png" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                JBL Tune 220TWS
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 col-md-6 col-sm-12">
                    <div class="product-card">
                        <div class="product-card-img">
                            <img src="./images/190402_E1_FW19_EarbudsWCase_S13_0033-1_1605x1605_HERO.png" alt="">
                            <img src="./images/190402_E1_FW19_EarbudsWCase_S13_0033-1_1605x1605_BACK.png" alt="">
                        </div>
                        <div class="product-card-info">
                            <div class="product-btn">
                                <a href="./product-detail.html" class="btn-flat btn-hover btn-shop-now">shop now</a>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-cart-add"></i>
                                </button>
                                <button class="btn-flat btn-hover btn-cart-add">
                                    <i class="bx bxs-heart"></i>
                                </button>
                            </div>
                            <div class="product-card-name">
                                UA Project Rock
                            </div>
                            <div class="product-card-price">
                                <span><del>400</del></span>
                                <span class="curr-price">300</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@code {
    [Parameter]
    public int id { get; set; }
    private Cart cart;
    private Product product;

    protected override async Task OnInitializedAsync()
    {
        product = new Product();
        var result = await _productSvc.Get(id);
        if (result.Success)
        {
            product = result.Data;
        }

        cart = new Cart() { Quantity = 1, Product = product };
    }

    private async void AddToCart()
    {
        await _cartSvc.AddAsync(cart.ToCartStorage());
        _toastSvc.ShowSuccess("Thêm thành công");
    }
}
